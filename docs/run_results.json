{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.13", "generated_at": "2024-04-26T08:54:16.265027Z", "invocation_id": "8d6ac8dd-dc6a-4373-b673-9b6423a16879", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T08:54:14.127873Z", "completed_at": "2024-04-26T08:54:14.157170Z"}, {"name": "execute", "started_at": "2024-04-26T08:54:14.159509Z", "completed_at": "2024-04-26T08:54:14.159526Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03684496879577637, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.klaviyo_source.stg_klaviyo__campaign_tmp", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"klaviyo_source_integration_tests_3000\".\"campaign\"", "relation_name": "\"postgres\".\"klaviyo_source_integration_tests_3000_stg_klaviyo\".\"stg_klaviyo__campaign_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T08:54:14.149208Z", "completed_at": "2024-04-26T08:54:14.157510Z"}, {"name": "execute", "started_at": "2024-04-26T08:54:14.160086Z", "completed_at": "2024-04-26T08:54:14.160090Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.037191152572631836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.klaviyo_source.stg_klaviyo__event_tmp", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"klaviyo_source_integration_tests_3000\".\"event\"", "relation_name": "\"postgres\".\"klaviyo_source_integration_tests_3000_stg_klaviyo\".\"stg_klaviyo__event_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T08:54:14.151907Z", "completed_at": "2024-04-26T08:54:14.157938Z"}, {"name": "execute", "started_at": "2024-04-26T08:54:14.160343Z", "completed_at": "2024-04-26T08:54:14.160347Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03717684745788574, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.klaviyo_source.stg_klaviyo__flow_tmp", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"klaviyo_source_integration_tests_3000\".\"flow\"", "relation_name": "\"postgres\".\"klaviyo_source_integration_tests_3000_stg_klaviyo\".\"stg_klaviyo__flow_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T08:54:14.154226Z", "completed_at": "2024-04-26T08:54:14.158610Z"}, {"name": "execute", "started_at": "2024-04-26T08:54:14.161235Z", "completed_at": "2024-04-26T08:54:14.161240Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03760385513305664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.klaviyo_source.stg_klaviyo__metric_tmp", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"klaviyo_source_integration_tests_3000\".\"metric\"", "relation_name": "\"postgres\".\"klaviyo_source_integration_tests_3000_stg_klaviyo\".\"stg_klaviyo__metric_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T08:54:14.170940Z", "completed_at": "2024-04-26T08:54:14.171871Z"}, {"name": "execute", "started_at": "2024-04-26T08:54:14.175673Z", "completed_at": "2024-04-26T08:54:14.175681Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.011466026306152344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.klaviyo_source_integration_tests.campaign", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T08:54:14.172145Z", "completed_at": "2024-04-26T08:54:14.172986Z"}, {"name": "execute", "started_at": "2024-04-26T08:54:14.175900Z", "completed_at": "2024-04-26T08:54:14.175903Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.011522054672241211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.klaviyo_source_integration_tests.event", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T08:54:14.173345Z", "completed_at": "2024-04-26T08:54:14.174395Z"}, {"name": "execute", "started_at": "2024-04-26T08:54:14.176115Z", "completed_at": "2024-04-26T08:54:14.176117Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.011343002319335938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.klaviyo_source_integration_tests.flow", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T08:54:14.167285Z", "completed_at": "2024-04-26T08:54:14.175427Z"}, {"name": "execute", "started_at": "2024-04-26T08:54:14.177873Z", "completed_at": "2024-04-26T08:54:14.177876Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.014679193496704102, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.klaviyo_source.stg_klaviyo__person_tmp", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"klaviyo_source_integration_tests_3000\".\"person\"", "relation_name": "\"postgres\".\"klaviyo_source_integration_tests_3000_stg_klaviyo\".\"stg_klaviyo__person_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T08:54:14.181623Z", "completed_at": "2024-04-26T08:54:14.182662Z"}, {"name": "execute", "started_at": "2024-04-26T08:54:14.197605Z", "completed_at": "2024-04-26T08:54:14.197616Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01955890655517578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.klaviyo_source_integration_tests.metric", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T08:54:14.182932Z", "completed_at": "2024-04-26T08:54:14.184630Z"}, {"name": "execute", "started_at": "2024-04-26T08:54:14.198028Z", "completed_at": "2024-04-26T08:54:14.198032Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.019711971282958984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.klaviyo_source_integration_tests.person", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T08:54:14.201797Z", "completed_at": "2024-04-26T08:54:15.123541Z"}, {"name": "execute", "started_at": "2024-04-26T08:54:15.124583Z", "completed_at": "2024-04-26T08:54:15.124594Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.0247600078582764, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.klaviyo_source.stg_klaviyo__flow", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"klaviyo_source_integration_tests_3000_stg_klaviyo\".\"stg_klaviyo__flow_tmp\"\n\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    created\n    \n as \n    \n    created\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    status\n    \n as \n    \n    status\n    \n, \n    \n    \n    updated\n    \n as \n    \n    updated\n    \n, \n    \n    \n    archived\n    \n as \n    \n    archived\n    \n, \n    \n    \n    trigger_type\n    \n as \n    \n    trigger_type\n    \n\n\n\n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n    from base\n),\n\nfinal as (\n    \n    select \n        created as created_at,\n        cast(id as TEXT ) as flow_id,\n        name as flow_name,\n        status,\n        updated as updated_at,\n        archived as is_archived,\n        trigger_type,\n        source_relation\n\n    from fields\n    where not coalesce(_fivetran_deleted, false)\n)\n\nselect * from final", "relation_name": "\"postgres\".\"klaviyo_source_integration_tests_3000_stg_klaviyo\".\"stg_klaviyo__flow\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T08:54:14.206656Z", "completed_at": "2024-04-26T08:54:15.156950Z"}, {"name": "execute", "started_at": "2024-04-26T08:54:15.158143Z", "completed_at": "2024-04-26T08:54:15.158150Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.038219928741455, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.klaviyo_source.stg_klaviyo__metric", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"klaviyo_source_integration_tests_3000_stg_klaviyo\".\"stg_klaviyo__metric_tmp\"\n\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    created\n    \n as \n    \n    created\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    integration_id\n    \n as \n    \n    integration_id\n    \n, \n    \n    \n    integration_category\n    \n as \n    \n    integration_category\n    \n, \n    \n    \n    integration_name\n    \n as \n    \n    integration_name\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    updated\n    \n as \n    \n    updated\n    \n\n\n\n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n    from base\n),\n\nfinal as (\n    \n    select \n        created as created_at,\n        cast(id as TEXT ) as metric_id,\n        cast(integration_id as TEXT ) as integration_id,\n        integration_name,\n        integration_category,\n        name as metric_name,\n        updated as updated_at,\n        source_relation\n\n    from fields\n\n    where not coalesce(_fivetran_deleted, false)\n)\n\nselect * from final", "relation_name": "\"postgres\".\"klaviyo_source_integration_tests_3000_stg_klaviyo\".\"stg_klaviyo__metric\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T08:54:15.240624Z", "completed_at": "2024-04-26T08:54:15.249622Z"}, {"name": "execute", "started_at": "2024-04-26T08:54:15.250132Z", "completed_at": "2024-04-26T08:54:15.250138Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.010602951049804688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.klaviyo_source.dbt_utils_unique_combination_of_columns_stg_klaviyo__flow_flow_id__source_relation.015215d481", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        flow_id, source_relation\n    from \"postgres\".\"klaviyo_source_integration_tests_3000_stg_klaviyo\".\"stg_klaviyo__flow\"\n    group by flow_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T08:54:15.251916Z", "completed_at": "2024-04-26T08:54:15.257722Z"}, {"name": "execute", "started_at": "2024-04-26T08:54:15.258182Z", "completed_at": "2024-04-26T08:54:15.258187Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.00747227668762207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.klaviyo_source.not_null_stg_klaviyo__flow_flow_id.a00a897e42", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect flow_id\nfrom \"postgres\".\"klaviyo_source_integration_tests_3000_stg_klaviyo\".\"stg_klaviyo__flow\"\nwhere flow_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T08:54:15.260056Z", "completed_at": "2024-04-26T08:54:15.263429Z"}, {"name": "execute", "started_at": "2024-04-26T08:54:15.263886Z", "completed_at": "2024-04-26T08:54:15.263894Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.005067110061645508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.klaviyo_source.dbt_utils_unique_combination_of_columns_stg_klaviyo__metric_metric_id__source_relation.e9f33c04e5", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        metric_id, source_relation\n    from \"postgres\".\"klaviyo_source_integration_tests_3000_stg_klaviyo\".\"stg_klaviyo__metric\"\n    group by metric_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T08:54:14.184916Z", "completed_at": "2024-04-26T08:54:15.157775Z"}, {"name": "execute", "started_at": "2024-04-26T08:54:15.159060Z", "completed_at": "2024-04-26T08:54:15.159064Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.0860018730163574, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.klaviyo_source.stg_klaviyo__campaign", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"klaviyo_source_integration_tests_3000_stg_klaviyo\".\"stg_klaviyo__campaign_tmp\"\n\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    campaign_type\n    \n as \n    \n    campaign_type\n    \n, \n    \n    \n    created\n    \n as \n    \n    created\n    \n, \n    \n    \n    email_template_id\n    \n as \n    \n    email_template_id\n    \n, \n    \n    \n    from_email\n    \n as \n    \n    from_email\n    \n, \n    \n    \n    from_name\n    \n as \n    \n    from_name\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    send_time\n    \n as \n    \n    send_time\n    \n, \n    \n    \n    sent_at\n    \n as \n    \n    sent_at\n    \n, \n    \n    \n    status\n    \n as \n    \n    status\n    \n, \n    \n    \n    status_id\n    \n as \n    \n    status_id\n    \n, \n    \n    \n    status_label\n    \n as \n    \n    status_label\n    \n, \n    \n    \n    subject\n    \n as \n    \n    subject\n    \n, \n    \n    \n    updated\n    \n as \n    \n    updated\n    \n, \n    \n    \n    archived\n    \n as \n    \n    archived\n    \n, \n    \n    \n    scheduled\n    \n as \n    \n    scheduled\n    \n\n\n\n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n    from base\n),\n\nfinal as (\n    \n    select\n        campaign_type,\n        created as created_at,\n        email_template_id,\n        from_email,\n        from_name,\n        cast(id as TEXT ) as campaign_id,\n        name as campaign_name,\n        send_time as scheduled_to_send_at,\n        sent_at,\n        coalesce(status, lower(status_label)) as status,\n        status_id,\n        subject,\n        updated as updated_at,\n        archived as is_archived,\n        scheduled as scheduled_at,\n        source_relation\n\n    from fields\n\n    where not coalesce(_fivetran_deleted, false)\n)\n\nselect * from final", "relation_name": "\"postgres\".\"klaviyo_source_integration_tests_3000_stg_klaviyo\".\"stg_klaviyo__campaign\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T08:54:15.266383Z", "completed_at": "2024-04-26T08:54:15.273974Z"}, {"name": "execute", "started_at": "2024-04-26T08:54:15.274581Z", "completed_at": "2024-04-26T08:54:15.274587Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009823799133300781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.klaviyo_source.not_null_stg_klaviyo__metric_metric_id.4759d62078", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect metric_id\nfrom \"postgres\".\"klaviyo_source_integration_tests_3000_stg_klaviyo\".\"stg_klaviyo__metric\"\nwhere metric_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T08:54:15.270501Z", "completed_at": "2024-04-26T08:54:15.275531Z"}, {"name": "execute", "started_at": "2024-04-26T08:54:15.276648Z", "completed_at": "2024-04-26T08:54:15.276651Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.00996088981628418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.klaviyo_source.dbt_utils_unique_combination_of_columns_stg_klaviyo__campaign_campaign_id__source_relation.59158488ff", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        campaign_id, source_relation\n    from \"postgres\".\"klaviyo_source_integration_tests_3000_stg_klaviyo\".\"stg_klaviyo__campaign\"\n    group by campaign_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T08:54:15.276883Z", "completed_at": "2024-04-26T08:54:15.280410Z"}, {"name": "execute", "started_at": "2024-04-26T08:54:15.280970Z", "completed_at": "2024-04-26T08:54:15.280976Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0055408477783203125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.klaviyo_source.not_null_stg_klaviyo__campaign_campaign_id.5dfc47dc1d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect campaign_id\nfrom \"postgres\".\"klaviyo_source_integration_tests_3000_stg_klaviyo\".\"stg_klaviyo__campaign\"\nwhere campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T08:54:14.192009Z", "completed_at": "2024-04-26T08:54:15.214645Z"}, {"name": "execute", "started_at": "2024-04-26T08:54:15.215177Z", "completed_at": "2024-04-26T08:54:15.215185Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.1287519931793213, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.klaviyo_source.stg_klaviyo__event", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"klaviyo_source_integration_tests_3000_stg_klaviyo\".\"stg_klaviyo__event_tmp\"\n\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    _variation\n    \n as \n    \n    _variation\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    datetime\n    \n as \n    \n    datetime\n    \n, \n    \n    \n    flow_id\n    \n as \n    \n    flow_id\n    \n, \n    \n    \n    flow_message_id\n    \n as \n    \n    flow_message_id\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    metric_id\n    \n as \n    \n    metric_id\n    \n, \n    \n    \n    person_id\n    \n as \n    \n    person_id\n    \n, \n    \n    \n    timestamp\n    \n as \n    \n    timestamp\n    \n, \n    \n    \n    type\n    \n as \n    \n    type\n    \n, \n    \n    \n    uuid\n    \n as \n    \n    uuid\n    \n, \n    \n    \n    property_value\n    \n as \n    \n    property_value\n    \n\n\n\n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n    from base\n),\n\nrename as (\n    \n    select \n        _variation as variation_id,\n        cast(campaign_id as TEXT ) as campaign_id,\n        cast(timestamp as timestamp ) as occurred_at,\n        cast(flow_id as TEXT ) as flow_id,\n        flow_message_id,\n        cast(id as TEXT ) as event_id,\n        cast(metric_id as TEXT ) as metric_id,\n        cast(person_id as TEXT ) as person_id,\n        type,\n        uuid,\n        \n            cast(regexp_replace(cast(property_value as TEXT), '[^0-9.]*', '', 'g') as numeric(28,6)) as numeric_value,\n        \n        cast(_fivetran_synced as timestamp ) as _fivetran_synced,\n        source_relation\n\n        \n\n\n\n\n\n    from fields\n    where not coalesce(_fivetran_deleted, false)\n),\n\nfinal as (\n    \n    select \n        *,\n        cast( date_trunc('day', occurred_at) as date) as occurred_on,\n        md5(cast(coalesce(cast(event_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(source_relation as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as unique_event_id\n\n    from rename\n\n)\n\nselect * from final", "relation_name": "\"postgres\".\"klaviyo_source_integration_tests_3000_stg_klaviyo\".\"stg_klaviyo__event\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T08:54:15.312670Z", "completed_at": "2024-04-26T08:54:15.319762Z"}, {"name": "execute", "started_at": "2024-04-26T08:54:15.320442Z", "completed_at": "2024-04-26T08:54:15.320450Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.010000228881835938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.klaviyo_source.dbt_utils_unique_combination_of_columns_stg_klaviyo__event_event_id__source_relation.3778c651d7", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        event_id, source_relation\n    from \"postgres\".\"klaviyo_source_integration_tests_3000_stg_klaviyo\".\"stg_klaviyo__event\"\n    group by event_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T08:54:15.316982Z", "completed_at": "2024-04-26T08:54:15.320722Z"}, {"name": "execute", "started_at": "2024-04-26T08:54:15.321889Z", "completed_at": "2024-04-26T08:54:15.321892Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.010665178298950195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.klaviyo_source.not_null_stg_klaviyo__event_event_id.7a09ac6ec1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"klaviyo_source_integration_tests_3000_stg_klaviyo\".\"stg_klaviyo__event\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T08:54:15.226856Z", "completed_at": "2024-04-26T08:54:16.132733Z"}, {"name": "execute", "started_at": "2024-04-26T08:54:16.133444Z", "completed_at": "2024-04-26T08:54:16.133452Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.0182390213012695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.klaviyo_source.stg_klaviyo__person", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"klaviyo_source_integration_tests_3000_stg_klaviyo\".\"stg_klaviyo__person_tmp\"\n\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    address_1\n    \n as \n    \n    address_1\n    \n, \n    \n    \n    address_2\n    \n as \n    \n    address_2\n    \n, \n    \n    \n    city\n    \n as \n    \n    city\n    \n, \n    \n    \n    country\n    \n as \n    \n    country\n    \n, \n    \n    \n    created\n    \n as \n    \n    created\n    \n, \n    \n    \n    email\n    \n as \n    \n    email\n    \n, \n    \n    \n    first_name\n    \n as \n    \n    first_name\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    last_name\n    \n as \n    \n    last_name\n    \n, \n    \n    \n    latitude\n    \n as \n    \n    latitude\n    \n, \n    \n    \n    longitude\n    \n as \n    \n    longitude\n    \n, \n    \n    \n    organization\n    \n as \n    \n    organization\n    \n, \n    \n    \n    phone_number\n    \n as \n    \n    phone_number\n    \n, \n    \n    \n    region\n    \n as \n    \n    region\n    \n, \n    \n    \n    timezone\n    \n as \n    \n    timezone\n    \n, \n    \n    \n    title\n    \n as \n    \n    title\n    \n, \n    \n    \n    updated\n    \n as \n    \n    updated\n    \n, \n    \n    \n    zip\n    \n as \n    \n    zip\n    \n, \n    \n    \n    last_event_date\n    \n as \n    \n    last_event_date\n    \n\n\n\n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n    from base\n),\n\nfinal as (\n    \n    select \n        cast(id as TEXT ) as person_id,\n        address_1,\n        address_2,\n        city,\n        country,\n        zip,\n        created as created_at,\n        email,\n        first_name || ' ' || last_name as full_name,\n        latitude,\n        longitude,\n        organization,\n        phone_number,\n        region, -- state in USA\n        timezone,\n        title,\n        updated as updated_at,\n        last_event_date,\n        source_relation\n        \n        \n\n\n\n\n\n    from fields\n    where not coalesce(_fivetran_deleted, false)\n)\n\nselect * from final", "relation_name": "\"postgres\".\"klaviyo_source_integration_tests_3000_stg_klaviyo\".\"stg_klaviyo__person\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T08:54:16.248485Z", "completed_at": "2024-04-26T08:54:16.258940Z"}, {"name": "execute", "started_at": "2024-04-26T08:54:16.259804Z", "completed_at": "2024-04-26T08:54:16.259812Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013919830322265625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.klaviyo_source.dbt_utils_unique_combination_of_columns_stg_klaviyo__person_person_id__source_relation.33a4f9ca24", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        person_id, source_relation\n    from \"postgres\".\"klaviyo_source_integration_tests_3000_stg_klaviyo\".\"stg_klaviyo__person\"\n    group by person_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T08:54:16.253458Z", "completed_at": "2024-04-26T08:54:16.261000Z"}, {"name": "execute", "started_at": "2024-04-26T08:54:16.261939Z", "completed_at": "2024-04-26T08:54:16.261946Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.015452861785888672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.klaviyo_source.not_null_stg_klaviyo__person_person_id.bd77ffc8aa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect person_id\nfrom \"postgres\".\"klaviyo_source_integration_tests_3000_stg_klaviyo\".\"stg_klaviyo__person\"\nwhere person_id is null\n\n\n", "relation_name": null}], "elapsed_time": 4.9925761222839355, "args": {"partial_parse_file_diff": true, "exclude": [], "target": "postgres", "cache_selected_only": false, "strict_mode": false, "project_dir": "/Users/avinash.kunnath/Documents/dbt_packages/klaviyo/dbt_klaviyo_source/integration_tests", "compile": true, "defer": false, "use_colors_file": true, "use_colors": true, "log_format": "default", "empty_catalog": false, "select": [], "show_resource_report": false, "vars": {}, "invocation_command": "dbt docs generate -t postgres", "favor_state": false, "macro_debugging": false, "introspect": true, "static_parser": true, "log_level_file": "debug", "send_anonymous_usage_stats": true, "quiet": false, "populate_cache": true, "version_check": true, "print": true, "log_level": "info", "warn_error_options": {"include": [], "exclude": []}, "write_json": true, "log_format_file": "debug", "log_path": "/Users/avinash.kunnath/Documents/dbt_packages/klaviyo/dbt_klaviyo_source/integration_tests/logs", "printer_width": 80, "which": "generate", "log_file_max_bytes": 10485760, "indirect_selection": "eager", "enable_legacy_logger": false, "static": false, "partial_parse": true, "profiles_dir": "/Users/avinash.kunnath/.dbt"}}
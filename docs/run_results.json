{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.13", "generated_at": "2024-04-26T21:21:44.079550Z", "invocation_id": "c975ffec-b379-43b4-8446-8e46cff8e687", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T21:21:40.707232Z", "completed_at": "2024-04-26T21:21:40.738538Z"}, {"name": "execute", "started_at": "2024-04-26T21:21:40.740170Z", "completed_at": "2024-04-26T21:21:40.740184Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03837084770202637, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.klaviyo_source.stg_klaviyo__campaign_tmp", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"klaviyo_source_integration_tests_3\".\"campaign\"", "relation_name": "\"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__campaign_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T21:21:40.730231Z", "completed_at": "2024-04-26T21:21:40.738832Z"}, {"name": "execute", "started_at": "2024-04-26T21:21:40.740633Z", "completed_at": "2024-04-26T21:21:40.740637Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0385279655456543, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.klaviyo_source.stg_klaviyo__event_tmp", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"klaviyo_source_integration_tests_3\".\"event\"", "relation_name": "\"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__event_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T21:21:40.732935Z", "completed_at": "2024-04-26T21:21:40.739085Z"}, {"name": "execute", "started_at": "2024-04-26T21:21:40.740908Z", "completed_at": "2024-04-26T21:21:40.740912Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.038289785385131836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.klaviyo_source.stg_klaviyo__flow_tmp", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"klaviyo_source_integration_tests_3\".\"flow\"", "relation_name": "\"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__flow_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T21:21:40.735493Z", "completed_at": "2024-04-26T21:21:40.739527Z"}, {"name": "execute", "started_at": "2024-04-26T21:21:40.741804Z", "completed_at": "2024-04-26T21:21:40.741810Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03837013244628906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.klaviyo_source.stg_klaviyo__metric_tmp", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"klaviyo_source_integration_tests_3\".\"metric\"", "relation_name": "\"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__metric_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T21:21:40.750421Z", "completed_at": "2024-04-26T21:21:40.751481Z"}, {"name": "execute", "started_at": "2024-04-26T21:21:40.755513Z", "completed_at": "2024-04-26T21:21:40.755520Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01182699203491211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.klaviyo_source_integration_tests.campaign", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T21:21:40.751784Z", "completed_at": "2024-04-26T21:21:40.752682Z"}, {"name": "execute", "started_at": "2024-04-26T21:21:40.755839Z", "completed_at": "2024-04-26T21:21:40.755843Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.011973142623901367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.klaviyo_source_integration_tests.event", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T21:21:40.753074Z", "completed_at": "2024-04-26T21:21:40.754175Z"}, {"name": "execute", "started_at": "2024-04-26T21:21:40.756139Z", "completed_at": "2024-04-26T21:21:40.756142Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.011965036392211914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.klaviyo_source_integration_tests.flow", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T21:21:40.746624Z", "completed_at": "2024-04-26T21:21:40.755260Z"}, {"name": "execute", "started_at": "2024-04-26T21:21:40.758255Z", "completed_at": "2024-04-26T21:21:40.758260Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01500391960144043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.klaviyo_source.stg_klaviyo__person_tmp", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"klaviyo_source_integration_tests_3\".\"person\"", "relation_name": "\"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__person_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T21:21:40.762056Z", "completed_at": "2024-04-26T21:21:40.763151Z"}, {"name": "execute", "started_at": "2024-04-26T21:21:40.776889Z", "completed_at": "2024-04-26T21:21:40.776896Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.018323183059692383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.klaviyo_source_integration_tests.metric", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T21:21:40.763421Z", "completed_at": "2024-04-26T21:21:40.765091Z"}, {"name": "execute", "started_at": "2024-04-26T21:21:40.777149Z", "completed_at": "2024-04-26T21:21:40.777153Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01849985122680664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.klaviyo_source_integration_tests.person", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T21:21:40.781240Z", "completed_at": "2024-04-26T21:21:42.273549Z"}, {"name": "execute", "started_at": "2024-04-26T21:21:42.274326Z", "completed_at": "2024-04-26T21:21:42.274338Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.616987943649292, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.klaviyo_source.stg_klaviyo__flow", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__flow_tmp\"\n\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    created\n    \n as \n    \n    created\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    status\n    \n as \n    \n    status\n    \n, \n    \n    \n    updated\n    \n as \n    \n    updated\n    \n, \n    \n    \n    archived\n    \n as \n    \n    archived\n    \n, \n    \n    \n    trigger_type\n    \n as \n    \n    trigger_type\n    \n\n\n\n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n    from base\n),\n\nfinal as (\n    \n    select \n        created as created_at,\n        cast(id as TEXT ) as flow_id,\n        name as flow_name,\n        status,\n        updated as updated_at,\n        archived as is_archived,\n        trigger_type,\n        source_relation\n\n    from fields\n    where not coalesce(_fivetran_deleted, false)\n)\n\nselect * from final", "relation_name": "\"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__flow\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T21:21:40.785973Z", "completed_at": "2024-04-26T21:21:42.439796Z"}, {"name": "execute", "started_at": "2024-04-26T21:21:42.460335Z", "completed_at": "2024-04-26T21:21:42.460344Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.7718939781188965, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.klaviyo_source.stg_klaviyo__metric", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__metric_tmp\"\n\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    created\n    \n as \n    \n    created\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    integration_id\n    \n as \n    \n    integration_id\n    \n, \n    \n    \n    integration_category\n    \n as \n    \n    integration_category\n    \n, \n    \n    \n    integration_name\n    \n as \n    \n    integration_name\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    updated\n    \n as \n    \n    updated\n    \n\n\n\n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n    from base\n),\n\nfinal as (\n    \n    select \n        created as created_at,\n        cast(id as TEXT ) as metric_id,\n        cast(integration_id as TEXT ) as integration_id,\n        integration_name,\n        integration_category,\n        name as metric_name,\n        updated as updated_at,\n        source_relation\n\n    from fields\n\n    where not coalesce(_fivetran_deleted, false)\n)\n\nselect * from final", "relation_name": "\"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__metric\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T21:21:40.771921Z", "completed_at": "2024-04-26T21:21:42.461772Z"}, {"name": "execute", "started_at": "2024-04-26T21:21:42.462477Z", "completed_at": "2024-04-26T21:21:42.462481Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.8045978546142578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.klaviyo_source.stg_klaviyo__event", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__event_tmp\"\n\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    _variation\n    \n as \n    \n    _variation\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    datetime\n    \n as \n    \n    datetime\n    \n, \n    \n    \n    flow_id\n    \n as \n    \n    flow_id\n    \n, \n    \n    \n    flow_message_id\n    \n as \n    \n    flow_message_id\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    metric_id\n    \n as \n    \n    metric_id\n    \n, \n    \n    \n    person_id\n    \n as \n    \n    person_id\n    \n, \n    \n    \n    timestamp\n    \n as \n    \n    timestamp\n    \n, \n    \n    \n    type\n    \n as \n    \n    type\n    \n, \n    \n    \n    uuid\n    \n as \n    \n    uuid\n    \n, \n    \n    \n    property_value\n    \n as \n    \n    property_value\n    \n\n\n\n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n    from base\n),\n\nrename as (\n    \n    select \n        _variation as variation_id,\n        cast(campaign_id as TEXT ) as campaign_id,\n        cast(timestamp as timestamp ) as occurred_at,\n        cast(flow_id as TEXT ) as flow_id,\n        flow_message_id,\n        cast(id as TEXT ) as event_id,\n        cast(metric_id as TEXT ) as metric_id,\n        cast(person_id as TEXT ) as person_id,\n        type,\n        uuid,\n        \n\n\n    cast(regexp_replace(cast(property_value as TEXT), '[^0-9.]*', '', 'g') as numeric(28,6))\n\n\n as numeric_value,\n        cast(_fivetran_synced as timestamp ) as _fivetran_synced,\n        source_relation\n        \n\n\n\n\n\n    from fields\n    where not coalesce(_fivetran_deleted, false)\n),\n\nfinal as (\n    \n    select \n        *,\n        cast( date_trunc('day', occurred_at) as date) as occurred_on,\n        md5(cast(coalesce(cast(event_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(source_relation as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as unique_event_id\n\n    from rename\n\n)\n\nselect * from final", "relation_name": "\"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__event\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T21:21:42.554500Z", "completed_at": "2024-04-26T21:21:42.565768Z"}, {"name": "execute", "started_at": "2024-04-26T21:21:42.567340Z", "completed_at": "2024-04-26T21:21:42.567348Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01487112045288086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.klaviyo_source.dbt_utils_unique_combination_of_columns_stg_klaviyo__flow_flow_id__source_relation.015215d481", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        flow_id, source_relation\n    from \"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__flow\"\n    group by flow_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T21:21:40.765347Z", "completed_at": "2024-04-26T21:21:42.460979Z"}, {"name": "execute", "started_at": "2024-04-26T21:21:42.461504Z", "completed_at": "2024-04-26T21:21:42.461508Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.8196678161621094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.klaviyo_source.stg_klaviyo__campaign", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__campaign_tmp\"\n\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    campaign_type\n    \n as \n    \n    campaign_type\n    \n, \n    \n    \n    created\n    \n as \n    \n    created\n    \n, \n    \n    \n    email_template_id\n    \n as \n    \n    email_template_id\n    \n, \n    \n    \n    from_email\n    \n as \n    \n    from_email\n    \n, \n    \n    \n    from_name\n    \n as \n    \n    from_name\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    send_time\n    \n as \n    \n    send_time\n    \n, \n    \n    \n    sent_at\n    \n as \n    \n    sent_at\n    \n, \n    \n    \n    status\n    \n as \n    \n    status\n    \n, \n    \n    \n    status_id\n    \n as \n    \n    status_id\n    \n, \n    \n    \n    status_label\n    \n as \n    \n    status_label\n    \n, \n    \n    \n    subject\n    \n as \n    \n    subject\n    \n, \n    \n    \n    updated\n    \n as \n    \n    updated\n    \n, \n    \n    \n    archived\n    \n as \n    \n    archived\n    \n, \n    \n    \n    scheduled\n    \n as \n    \n    scheduled\n    \n\n\n\n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n    from base\n),\n\nfinal as (\n    \n    select\n        campaign_type,\n        created as created_at,\n        email_template_id,\n        from_email,\n        from_name,\n        cast(id as TEXT ) as campaign_id,\n        name as campaign_name,\n        send_time as scheduled_to_send_at,\n        sent_at,\n        coalesce(status, lower(status_label)) as status,\n        status_id,\n        subject,\n        updated as updated_at,\n        archived as is_archived,\n        scheduled as scheduled_at,\n        source_relation\n\n    from fields\n\n    where not coalesce(_fivetran_deleted, false)\n)\n\nselect * from final", "relation_name": "\"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__campaign\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T21:21:42.569320Z", "completed_at": "2024-04-26T21:21:42.581500Z"}, {"name": "execute", "started_at": "2024-04-26T21:21:42.585229Z", "completed_at": "2024-04-26T21:21:42.585234Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.018170833587646484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.klaviyo_source.not_null_stg_klaviyo__flow_flow_id.a00a897e42", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect flow_id\nfrom \"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__flow\"\nwhere flow_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T21:21:42.576761Z", "completed_at": "2024-04-26T21:21:42.582225Z"}, {"name": "execute", "started_at": "2024-04-26T21:21:42.586277Z", "completed_at": "2024-04-26T21:21:42.586280Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.011253833770751953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.klaviyo_source.dbt_utils_unique_combination_of_columns_stg_klaviyo__metric_metric_id__source_relation.e9f33c04e5", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        metric_id, source_relation\n    from \"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__metric\"\n    group by metric_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T21:21:42.582468Z", "completed_at": "2024-04-26T21:21:42.586820Z"}, {"name": "execute", "started_at": "2024-04-26T21:21:42.588600Z", "completed_at": "2024-04-26T21:21:42.588605Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.011402130126953125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.klaviyo_source.not_null_stg_klaviyo__metric_metric_id.4759d62078", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect metric_id\nfrom \"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__metric\"\nwhere metric_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T21:21:42.589268Z", "completed_at": "2024-04-26T21:21:42.596239Z"}, {"name": "execute", "started_at": "2024-04-26T21:21:42.600982Z", "completed_at": "2024-04-26T21:21:42.600989Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.014173746109008789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.klaviyo_source.dbt_utils_unique_combination_of_columns_stg_klaviyo__event_event_id__source_relation.3778c651d7", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        event_id, source_relation\n    from \"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__event\"\n    group by event_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T21:21:42.593329Z", "completed_at": "2024-04-26T21:21:42.600741Z"}, {"name": "execute", "started_at": "2024-04-26T21:21:42.602005Z", "completed_at": "2024-04-26T21:21:42.602009Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.013980865478515625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.klaviyo_source.not_null_stg_klaviyo__event_event_id.7a09ac6ec1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__event\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T21:21:42.597015Z", "completed_at": "2024-04-26T21:21:42.602222Z"}, {"name": "execute", "started_at": "2024-04-26T21:21:42.603737Z", "completed_at": "2024-04-26T21:21:42.603741Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.008444070816040039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.klaviyo_source.dbt_utils_unique_combination_of_columns_stg_klaviyo__campaign_campaign_id__source_relation.59158488ff", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        campaign_id, source_relation\n    from \"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__campaign\"\n    group by campaign_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T21:21:42.604624Z", "completed_at": "2024-04-26T21:21:42.607493Z"}, {"name": "execute", "started_at": "2024-04-26T21:21:42.607939Z", "completed_at": "2024-04-26T21:21:42.607943Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0049800872802734375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.klaviyo_source.not_null_stg_klaviyo__campaign_campaign_id.5dfc47dc1d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect campaign_id\nfrom \"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__campaign\"\nwhere campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T21:21:42.400699Z", "completed_at": "2024-04-26T21:21:43.933929Z"}, {"name": "execute", "started_at": "2024-04-26T21:21:43.934916Z", "completed_at": "2024-04-26T21:21:43.934938Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.663381814956665, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.klaviyo_source.stg_klaviyo__person", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__person_tmp\"\n\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    address_1\n    \n as \n    \n    address_1\n    \n, \n    \n    \n    address_2\n    \n as \n    \n    address_2\n    \n, \n    \n    \n    city\n    \n as \n    \n    city\n    \n, \n    \n    \n    country\n    \n as \n    \n    country\n    \n, \n    \n    \n    created\n    \n as \n    \n    created\n    \n, \n    \n    \n    email\n    \n as \n    \n    email\n    \n, \n    \n    \n    first_name\n    \n as \n    \n    first_name\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    last_name\n    \n as \n    \n    last_name\n    \n, \n    \n    \n    latitude\n    \n as \n    \n    latitude\n    \n, \n    \n    \n    longitude\n    \n as \n    \n    longitude\n    \n, \n    \n    \n    organization\n    \n as \n    \n    organization\n    \n, \n    \n    \n    phone_number\n    \n as \n    \n    phone_number\n    \n, \n    \n    \n    region\n    \n as \n    \n    region\n    \n, \n    \n    \n    timezone\n    \n as \n    \n    timezone\n    \n, \n    \n    \n    title\n    \n as \n    \n    title\n    \n, \n    \n    \n    updated\n    \n as \n    \n    updated\n    \n, \n    \n    \n    zip\n    \n as \n    \n    zip\n    \n, \n    \n    \n    last_event_date\n    \n as \n    \n    last_event_date\n    \n\n\n\n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n    from base\n),\n\nfinal as (\n    \n    select \n        cast(id as TEXT ) as person_id,\n        address_1,\n        address_2,\n        city,\n        country,\n        zip,\n        created as created_at,\n        email,\n        first_name || ' ' || last_name as full_name,\n        latitude,\n        longitude,\n        organization,\n        phone_number,\n        region, -- state in USA\n        timezone,\n        title,\n        updated as updated_at,\n        last_event_date,\n        source_relation\n        \n        \n\n\n\n\n\n    from fields\n    where not coalesce(_fivetran_deleted, false)\n)\n\nselect * from final", "relation_name": "\"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__person\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T21:21:44.070868Z", "completed_at": "2024-04-26T21:21:44.074708Z"}, {"name": "execute", "started_at": "2024-04-26T21:21:44.076111Z", "completed_at": "2024-04-26T21:21:44.076119Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.012179851531982422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.klaviyo_source.not_null_stg_klaviyo__person_person_id.bd77ffc8aa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect person_id\nfrom \"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__person\"\nwhere person_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-26T21:21:44.065827Z", "completed_at": "2024-04-26T21:21:44.075048Z"}, {"name": "execute", "started_at": "2024-04-26T21:21:44.076442Z", "completed_at": "2024-04-26T21:21:44.076447Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.013422727584838867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.klaviyo_source.dbt_utils_unique_combination_of_columns_stg_klaviyo__person_person_id__source_relation.33a4f9ca24", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        person_id, source_relation\n    from \"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__person\"\n    group by person_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}], "elapsed_time": 7.758110046386719, "args": {"defer": false, "vars": {}, "cache_selected_only": false, "populate_cache": true, "static_parser": true, "use_colors_file": true, "write_json": true, "profiles_dir": "/Users/avinash.kunnath/.dbt", "show_resource_report": false, "enable_legacy_logger": false, "empty_catalog": false, "print": true, "log_level": "info", "favor_state": false, "exclude": [], "target": "postgres", "indirect_selection": "eager", "quiet": false, "select": [], "log_format_file": "debug", "partial_parse": true, "introspect": true, "which": "generate", "log_format": "default", "partial_parse_file_diff": true, "static": false, "use_colors": true, "strict_mode": false, "log_file_max_bytes": 10485760, "log_level_file": "debug", "invocation_command": "dbt docs generate -t postgres", "log_path": "/Users/avinash.kunnath/Documents/dbt_packages/klaviyo/dbt_klaviyo_source/integration_tests/logs", "printer_width": 80, "compile": true, "project_dir": "/Users/avinash.kunnath/Documents/dbt_packages/klaviyo/dbt_klaviyo_source/integration_tests", "send_anonymous_usage_stats": true, "version_check": true, "warn_error_options": {"include": [], "exclude": []}, "macro_debugging": false}}
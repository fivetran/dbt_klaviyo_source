{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.13", "generated_at": "2024-04-29T16:17:46.550318Z", "invocation_id": "5032be99-28ef-4bf4-8665-b15df094d6c8", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-29T16:17:44.048765Z", "completed_at": "2024-04-29T16:17:44.057225Z"}, {"name": "execute", "started_at": "2024-04-29T16:17:44.059112Z", "completed_at": "2024-04-29T16:17:44.059130Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.037004947662353516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.klaviyo_source.stg_klaviyo__event_tmp", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"klaviyo_source_integration_tests_3\".\"event\"", "relation_name": "\"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__event_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-29T16:17:44.053901Z", "completed_at": "2024-04-29T16:17:44.057681Z"}, {"name": "execute", "started_at": "2024-04-29T16:17:44.059878Z", "completed_at": "2024-04-29T16:17:44.059882Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03694486618041992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.klaviyo_source.stg_klaviyo__metric_tmp", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"klaviyo_source_integration_tests_3\".\"metric\"", "relation_name": "\"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__metric_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-29T16:17:44.051436Z", "completed_at": "2024-04-29T16:17:44.058292Z"}, {"name": "execute", "started_at": "2024-04-29T16:17:44.060694Z", "completed_at": "2024-04-29T16:17:44.060697Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.038433074951171875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.klaviyo_source.stg_klaviyo__flow_tmp", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"klaviyo_source_integration_tests_3\".\"flow\"", "relation_name": "\"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__flow_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-29T16:17:44.026546Z", "completed_at": "2024-04-29T16:17:44.058542Z"}, {"name": "execute", "started_at": "2024-04-29T16:17:44.060955Z", "completed_at": "2024-04-29T16:17:44.060958Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.040065765380859375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.klaviyo_source.stg_klaviyo__campaign_tmp", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"klaviyo_source_integration_tests_3\".\"campaign\"", "relation_name": "\"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__campaign_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-29T16:17:44.070626Z", "completed_at": "2024-04-29T16:17:44.071657Z"}, {"name": "execute", "started_at": "2024-04-29T16:17:44.076244Z", "completed_at": "2024-04-29T16:17:44.076251Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.012575864791870117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.klaviyo_source_integration_tests.campaign", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-29T16:17:44.072127Z", "completed_at": "2024-04-29T16:17:44.073287Z"}, {"name": "execute", "started_at": "2024-04-29T16:17:44.076475Z", "completed_at": "2024-04-29T16:17:44.076478Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.012324094772338867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.klaviyo_source_integration_tests.event", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-29T16:17:44.073748Z", "completed_at": "2024-04-29T16:17:44.074791Z"}, {"name": "execute", "started_at": "2024-04-29T16:17:44.076715Z", "completed_at": "2024-04-29T16:17:44.076718Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.012260198593139648, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.klaviyo_source_integration_tests.flow", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-29T16:17:44.066788Z", "completed_at": "2024-04-29T16:17:44.075115Z"}, {"name": "execute", "started_at": "2024-04-29T16:17:44.076940Z", "completed_at": "2024-04-29T16:17:44.076942Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.015239238739013672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.klaviyo_source.stg_klaviyo__person_tmp", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"klaviyo_source_integration_tests_3\".\"person\"", "relation_name": "\"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__person_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-29T16:17:44.082381Z", "completed_at": "2024-04-29T16:17:44.083501Z"}, {"name": "execute", "started_at": "2024-04-29T16:17:44.097099Z", "completed_at": "2024-04-29T16:17:44.097105Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.017846107482910156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.klaviyo_source_integration_tests.metric", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-29T16:17:44.083812Z", "completed_at": "2024-04-29T16:17:44.085490Z"}, {"name": "execute", "started_at": "2024-04-29T16:17:44.097335Z", "completed_at": "2024-04-29T16:17:44.097338Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.017935991287231445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.klaviyo_source_integration_tests.person", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-29T16:17:44.100897Z", "completed_at": "2024-04-29T16:17:45.334596Z"}, {"name": "execute", "started_at": "2024-04-29T16:17:45.336310Z", "completed_at": "2024-04-29T16:17:45.336313Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.3319978713989258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.klaviyo_source.stg_klaviyo__flow", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__flow_tmp\"\n\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    created\n    \n as \n    \n    created\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    status\n    \n as \n    \n    status\n    \n, \n    \n    \n    updated\n    \n as \n    \n    updated\n    \n, \n    \n    \n    archived\n    \n as \n    \n    archived\n    \n, \n    \n    \n    trigger_type\n    \n as \n    \n    trigger_type\n    \n\n\n\n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n    from base\n),\n\nfinal as (\n    \n    select \n        created as created_at,\n        cast(id as TEXT ) as flow_id,\n        name as flow_name,\n        status,\n        updated as updated_at,\n        archived as is_archived,\n        trigger_type,\n        source_relation\n\n    from fields\n    where not coalesce(_fivetran_deleted, false)\n)\n\nselect * from final", "relation_name": "\"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__flow\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-29T16:17:44.105398Z", "completed_at": "2024-04-29T16:17:45.333335Z"}, {"name": "execute", "started_at": "2024-04-29T16:17:45.334856Z", "completed_at": "2024-04-29T16:17:45.334867Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.332779884338379, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.klaviyo_source.stg_klaviyo__campaign", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__campaign_tmp\"\n\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    campaign_type\n    \n as \n    \n    campaign_type\n    \n, \n    \n    \n    created\n    \n as \n    \n    created\n    \n, \n    \n    \n    email_template_id\n    \n as \n    \n    email_template_id\n    \n, \n    \n    \n    from_email\n    \n as \n    \n    from_email\n    \n, \n    \n    \n    from_name\n    \n as \n    \n    from_name\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    send_time\n    \n as \n    \n    send_time\n    \n, \n    \n    \n    sent_at\n    \n as \n    \n    sent_at\n    \n, \n    \n    \n    status\n    \n as \n    \n    status\n    \n, \n    \n    \n    status_id\n    \n as \n    \n    status_id\n    \n, \n    \n    \n    status_label\n    \n as \n    \n    status_label\n    \n, \n    \n    \n    subject\n    \n as \n    \n    subject\n    \n, \n    \n    \n    updated\n    \n as \n    \n    updated\n    \n, \n    \n    \n    archived\n    \n as \n    \n    archived\n    \n, \n    \n    \n    scheduled\n    \n as \n    \n    scheduled\n    \n\n\n\n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n    from base\n),\n\nfinal as (\n    \n    select\n        campaign_type,\n        created as created_at,\n        email_template_id,\n        from_email,\n        from_name,\n        cast(id as TEXT ) as campaign_id,\n        name as campaign_name,\n        send_time as scheduled_to_send_at,\n        sent_at,\n        coalesce(status, lower(status_label)) as status,\n        status_id,\n        subject,\n        updated as updated_at,\n        archived as is_archived,\n        scheduled as scheduled_at,\n        source_relation\n\n    from fields\n\n    where not coalesce(_fivetran_deleted, false)\n)\n\nselect * from final", "relation_name": "\"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__campaign\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-29T16:17:44.085764Z", "completed_at": "2024-04-29T16:17:45.335609Z"}, {"name": "execute", "started_at": "2024-04-29T16:17:45.337066Z", "completed_at": "2024-04-29T16:17:45.337070Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.3533310890197754, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.klaviyo_source.stg_klaviyo__event", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__event_tmp\"\n\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    _variation\n    \n as \n    \n    _variation\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    datetime\n    \n as \n    \n    datetime\n    \n, \n    \n    \n    flow_id\n    \n as \n    \n    flow_id\n    \n, \n    \n    \n    flow_message_id\n    \n as \n    \n    flow_message_id\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    metric_id\n    \n as \n    \n    metric_id\n    \n, \n    \n    \n    person_id\n    \n as \n    \n    person_id\n    \n, \n    \n    \n    timestamp\n    \n as \n    \n    timestamp\n    \n, \n    \n    \n    type\n    \n as \n    \n    type\n    \n, \n    \n    \n    uuid\n    \n as \n    \n    uuid\n    \n, \n    \n    \n    property_value\n    \n as \n    \n    property_value\n    \n\n\n\n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n    from base\n),\n\nrename as (\n    \n    select \n        _variation as variation_id,\n        cast(campaign_id as TEXT ) as campaign_id,\n        cast(timestamp as timestamp ) as occurred_at,\n        cast(flow_id as TEXT ) as flow_id,\n        flow_message_id,\n        cast(id as TEXT ) as event_id,\n        cast(metric_id as TEXT ) as metric_id,\n        cast(person_id as TEXT ) as person_id,\n        type,\n        uuid,\n        \n\n    cast(regexp_replace(cast(property_value as TEXT), '[^0-9.]*', '', 'g') as numeric(28,6))\n\n as numeric_value,\n        cast(_fivetran_synced as timestamp ) as _fivetran_synced,\n        source_relation\n        \n\n\n\n\n\n    from fields\n    where not coalesce(_fivetran_deleted, false)\n),\n\nfinal as (\n    \n    select \n        *,\n        cast( date_trunc('day', occurred_at) as date) as occurred_on,\n        md5(cast(coalesce(cast(event_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(source_relation as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as unique_event_id\n\n    from rename\n\n)\n\nselect * from final", "relation_name": "\"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__event\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-29T16:17:44.092706Z", "completed_at": "2024-04-29T16:17:45.333751Z"}, {"name": "execute", "started_at": "2024-04-29T16:17:45.335153Z", "completed_at": "2024-04-29T16:17:45.335157Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.3614368438720703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.klaviyo_source.stg_klaviyo__metric", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__metric_tmp\"\n\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    created\n    \n as \n    \n    created\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    integration_id\n    \n as \n    \n    integration_id\n    \n, \n    \n    \n    integration_category\n    \n as \n    \n    integration_category\n    \n, \n    \n    \n    integration_name\n    \n as \n    \n    integration_name\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    updated\n    \n as \n    \n    updated\n    \n\n\n\n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n    from base\n),\n\nfinal as (\n    \n    select \n        created as created_at,\n        cast(id as TEXT ) as metric_id,\n        cast(integration_id as TEXT ) as integration_id,\n        integration_name,\n        integration_category,\n        name as metric_name,\n        updated as updated_at,\n        source_relation\n\n    from fields\n\n    where not coalesce(_fivetran_deleted, false)\n)\n\nselect * from final", "relation_name": "\"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__metric\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-29T16:17:45.444137Z", "completed_at": "2024-04-29T16:17:45.462494Z"}, {"name": "execute", "started_at": "2024-04-29T16:17:45.463881Z", "completed_at": "2024-04-29T16:17:45.463888Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02390599250793457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.klaviyo_source.dbt_utils_unique_combination_of_columns_stg_klaviyo__flow_flow_id__source_relation.015215d481", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        flow_id, source_relation\n    from \"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__flow\"\n    group by flow_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-29T16:17:45.452935Z", "completed_at": "2024-04-29T16:17:45.462813Z"}, {"name": "execute", "started_at": "2024-04-29T16:17:45.464348Z", "completed_at": "2024-04-29T16:17:45.464351Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.023766756057739258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.klaviyo_source.not_null_stg_klaviyo__flow_flow_id.a00a897e42", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect flow_id\nfrom \"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__flow\"\nwhere flow_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-29T16:17:45.458987Z", "completed_at": "2024-04-29T16:17:45.463354Z"}, {"name": "execute", "started_at": "2024-04-29T16:17:45.465130Z", "completed_at": "2024-04-29T16:17:45.465133Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.008224964141845703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.klaviyo_source.dbt_utils_unique_combination_of_columns_stg_klaviyo__campaign_campaign_id__source_relation.59158488ff", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        campaign_id, source_relation\n    from \"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__campaign\"\n    group by campaign_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-29T16:17:45.468720Z", "completed_at": "2024-04-29T16:17:45.478630Z"}, {"name": "execute", "started_at": "2024-04-29T16:17:45.479212Z", "completed_at": "2024-04-29T16:17:45.479217Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.013121843338012695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.klaviyo_source.not_null_stg_klaviyo__campaign_campaign_id.5dfc47dc1d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect campaign_id\nfrom \"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__campaign\"\nwhere campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-29T16:17:45.475055Z", "completed_at": "2024-04-29T16:17:45.479454Z"}, {"name": "execute", "started_at": "2024-04-29T16:17:45.481178Z", "completed_at": "2024-04-29T16:17:45.481183Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.014341115951538086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.klaviyo_source.not_null_stg_klaviyo__event_event_id.7a09ac6ec1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__event\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-29T16:17:45.471829Z", "completed_at": "2024-04-29T16:17:45.479688Z"}, {"name": "execute", "started_at": "2024-04-29T16:17:45.481548Z", "completed_at": "2024-04-29T16:17:45.481553Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015399932861328125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.klaviyo_source.dbt_utils_unique_combination_of_columns_stg_klaviyo__event_event_id__source_relation.3778c651d7", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        event_id, source_relation\n    from \"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__event\"\n    group by event_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-29T16:17:45.484087Z", "completed_at": "2024-04-29T16:17:45.490967Z"}, {"name": "execute", "started_at": "2024-04-29T16:17:45.491952Z", "completed_at": "2024-04-29T16:17:45.491961Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.010837078094482422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.klaviyo_source.dbt_utils_unique_combination_of_columns_stg_klaviyo__metric_metric_id__source_relation.e9f33c04e5", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        metric_id, source_relation\n    from \"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__metric\"\n    group by metric_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-29T16:17:45.488043Z", "completed_at": "2024-04-29T16:17:45.491596Z"}, {"name": "execute", "started_at": "2024-04-29T16:17:45.493051Z", "completed_at": "2024-04-29T16:17:45.493055Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.006211042404174805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.klaviyo_source.not_null_stg_klaviyo__metric_metric_id.4759d62078", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect metric_id\nfrom \"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__metric\"\nwhere metric_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-29T16:17:45.435457Z", "completed_at": "2024-04-29T16:17:46.401405Z"}, {"name": "execute", "started_at": "2024-04-29T16:17:46.402342Z", "completed_at": "2024-04-29T16:17:46.402355Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.0901687145233154, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.klaviyo_source.stg_klaviyo__person", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__person_tmp\"\n\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    address_1\n    \n as \n    \n    address_1\n    \n, \n    \n    \n    address_2\n    \n as \n    \n    address_2\n    \n, \n    \n    \n    city\n    \n as \n    \n    city\n    \n, \n    \n    \n    country\n    \n as \n    \n    country\n    \n, \n    \n    \n    created\n    \n as \n    \n    created\n    \n, \n    \n    \n    email\n    \n as \n    \n    email\n    \n, \n    \n    \n    first_name\n    \n as \n    \n    first_name\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    last_name\n    \n as \n    \n    last_name\n    \n, \n    \n    \n    latitude\n    \n as \n    \n    latitude\n    \n, \n    \n    \n    longitude\n    \n as \n    \n    longitude\n    \n, \n    \n    \n    organization\n    \n as \n    \n    organization\n    \n, \n    \n    \n    phone_number\n    \n as \n    \n    phone_number\n    \n, \n    \n    \n    region\n    \n as \n    \n    region\n    \n, \n    \n    \n    timezone\n    \n as \n    \n    timezone\n    \n, \n    \n    \n    title\n    \n as \n    \n    title\n    \n, \n    \n    \n    updated\n    \n as \n    \n    updated\n    \n, \n    \n    \n    zip\n    \n as \n    \n    zip\n    \n, \n    \n    \n    last_event_date\n    \n as \n    \n    last_event_date\n    \n\n\n\n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n    from base\n),\n\nfinal as (\n    \n    select \n        cast(id as TEXT ) as person_id,\n        address_1,\n        address_2,\n        city,\n        country,\n        zip,\n        created as created_at,\n        email,\n        first_name || ' ' || last_name as full_name,\n        latitude,\n        longitude,\n        organization,\n        phone_number,\n        region, -- state in USA\n        timezone,\n        title,\n        updated as updated_at,\n        last_event_date,\n        source_relation\n        \n        \n\n\n\n\n\n    from fields\n    where not coalesce(_fivetran_deleted, false)\n)\n\nselect * from final", "relation_name": "\"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__person\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-29T16:17:46.537877Z", "completed_at": "2024-04-29T16:17:46.544618Z"}, {"name": "execute", "started_at": "2024-04-29T16:17:46.546346Z", "completed_at": "2024-04-29T16:17:46.546354Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02263927459716797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.klaviyo_source.not_null_stg_klaviyo__person_person_id.bd77ffc8aa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect person_id\nfrom \"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__person\"\nwhere person_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-29T16:17:46.527101Z", "completed_at": "2024-04-29T16:17:46.545046Z"}, {"name": "execute", "started_at": "2024-04-29T16:17:46.546739Z", "completed_at": "2024-04-29T16:17:46.546743Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.023901939392089844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.klaviyo_source.dbt_utils_unique_combination_of_columns_stg_klaviyo__person_person_id__source_relation.33a4f9ca24", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        person_id, source_relation\n    from \"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__person\"\n    group by person_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}], "elapsed_time": 5.52816104888916, "args": {"which": "generate", "empty_catalog": false, "profiles_dir": "/Users/avinash.kunnath/.dbt", "log_level_file": "debug", "strict_mode": false, "version_check": true, "write_json": true, "project_dir": "/Users/avinash.kunnath/Documents/dbt_packages/klaviyo/dbt_klaviyo_source/integration_tests", "log_level": "info", "enable_legacy_logger": false, "introspect": true, "use_colors": true, "macro_debugging": false, "select": [], "defer": false, "warn_error_options": {"include": [], "exclude": []}, "invocation_command": "dbt docs generate -t postgres", "cache_selected_only": false, "log_format_file": "debug", "favor_state": false, "show_resource_report": false, "static_parser": true, "vars": {}, "log_format": "default", "compile": true, "log_path": "/Users/avinash.kunnath/Documents/dbt_packages/klaviyo/dbt_klaviyo_source/integration_tests/logs", "printer_width": 80, "indirect_selection": "eager", "send_anonymous_usage_stats": true, "use_colors_file": true, "target": "postgres", "partial_parse_file_diff": true, "populate_cache": true, "exclude": [], "quiet": false, "static": false, "log_file_max_bytes": 10485760, "print": true, "partial_parse": true}}
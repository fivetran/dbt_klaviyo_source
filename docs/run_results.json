{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.13", "generated_at": "2024-04-29T15:48:05.087850Z", "invocation_id": "337def9a-4339-48d2-bfa1-fdc5c0ea9da4", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-29T15:48:02.213981Z", "completed_at": "2024-04-29T15:48:02.257943Z"}, {"name": "execute", "started_at": "2024-04-29T15:48:02.260077Z", "completed_at": "2024-04-29T15:48:02.260098Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0623018741607666, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.klaviyo_source.stg_klaviyo__campaign_tmp", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"klaviyo_source_integration_tests_3\".\"campaign\"", "relation_name": "\"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__campaign_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-29T15:48:02.251693Z", "completed_at": "2024-04-29T15:48:02.258713Z"}, {"name": "execute", "started_at": "2024-04-29T15:48:02.262405Z", "completed_at": "2024-04-29T15:48:02.262410Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.05261993408203125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.klaviyo_source.stg_klaviyo__flow_tmp", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"klaviyo_source_integration_tests_3\".\"flow\"", "relation_name": "\"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__flow_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-29T15:48:02.247009Z", "completed_at": "2024-04-29T15:48:02.259049Z"}, {"name": "execute", "started_at": "2024-04-29T15:48:02.262681Z", "completed_at": "2024-04-29T15:48:02.262686Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.061834096908569336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.klaviyo_source.stg_klaviyo__event_tmp", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"klaviyo_source_integration_tests_3\".\"event\"", "relation_name": "\"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__event_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-29T15:48:02.254819Z", "completed_at": "2024-04-29T15:48:02.260509Z"}, {"name": "execute", "started_at": "2024-04-29T15:48:02.263533Z", "completed_at": "2024-04-29T15:48:02.263543Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.05344796180725098, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.klaviyo_source.stg_klaviyo__metric_tmp", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"klaviyo_source_integration_tests_3\".\"metric\"", "relation_name": "\"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__metric_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-29T15:48:02.274404Z", "completed_at": "2024-04-29T15:48:02.275615Z"}, {"name": "execute", "started_at": "2024-04-29T15:48:02.280368Z", "completed_at": "2024-04-29T15:48:02.280376Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.013888120651245117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.klaviyo_source_integration_tests.campaign", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-29T15:48:02.275957Z", "completed_at": "2024-04-29T15:48:02.277065Z"}, {"name": "execute", "started_at": "2024-04-29T15:48:02.280761Z", "completed_at": "2024-04-29T15:48:02.280767Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.013966798782348633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.klaviyo_source_integration_tests.event", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-29T15:48:02.269011Z", "completed_at": "2024-04-29T15:48:02.277441Z"}, {"name": "execute", "started_at": "2024-04-29T15:48:02.281061Z", "completed_at": "2024-04-29T15:48:02.281068Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.017575979232788086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.klaviyo_source.stg_klaviyo__person_tmp", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"klaviyo_source_integration_tests_3\".\"person\"", "relation_name": "\"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__person_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-29T15:48:02.277790Z", "completed_at": "2024-04-29T15:48:02.278791Z"}, {"name": "execute", "started_at": "2024-04-29T15:48:02.281427Z", "completed_at": "2024-04-29T15:48:02.281435Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.010523080825805664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.klaviyo_source_integration_tests.flow", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-29T15:48:02.287670Z", "completed_at": "2024-04-29T15:48:02.288807Z"}, {"name": "execute", "started_at": "2024-04-29T15:48:02.301998Z", "completed_at": "2024-04-29T15:48:02.302005Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01800227165222168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.klaviyo_source_integration_tests.metric", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-29T15:48:02.289094Z", "completed_at": "2024-04-29T15:48:02.290673Z"}, {"name": "execute", "started_at": "2024-04-29T15:48:02.302267Z", "completed_at": "2024-04-29T15:48:02.302271Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.018136024475097656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.klaviyo_source_integration_tests.person", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-29T15:48:02.296896Z", "completed_at": "2024-04-29T15:48:03.304692Z"}, {"name": "execute", "started_at": "2024-04-29T15:48:03.305659Z", "completed_at": "2024-04-29T15:48:03.305672Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.1499838829040527, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.klaviyo_source.stg_klaviyo__flow", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__flow_tmp\"\n\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    created\n    \n as \n    \n    created\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    status\n    \n as \n    \n    status\n    \n, \n    \n    \n    updated\n    \n as \n    \n    updated\n    \n, \n    \n    \n    archived\n    \n as \n    \n    archived\n    \n, \n    \n    \n    trigger_type\n    \n as \n    \n    trigger_type\n    \n\n\n\n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n    from base\n),\n\nfinal as (\n    \n    select \n        created as created_at,\n        cast(id as TEXT ) as flow_id,\n        name as flow_name,\n        status,\n        updated as updated_at,\n        archived as is_archived,\n        trigger_type,\n        source_relation\n\n    from fields\n    where not coalesce(_fivetran_deleted, false)\n)\n\nselect * from final", "relation_name": "\"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__flow\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-29T15:48:02.306091Z", "completed_at": "2024-04-29T15:48:03.339231Z"}, {"name": "execute", "started_at": "2024-04-29T15:48:03.339740Z", "completed_at": "2024-04-29T15:48:03.339746Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.1345758438110352, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.klaviyo_source.stg_klaviyo__event", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__event_tmp\"\n\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    _variation\n    \n as \n    \n    _variation\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    datetime\n    \n as \n    \n    datetime\n    \n, \n    \n    \n    flow_id\n    \n as \n    \n    flow_id\n    \n, \n    \n    \n    flow_message_id\n    \n as \n    \n    flow_message_id\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    metric_id\n    \n as \n    \n    metric_id\n    \n, \n    \n    \n    person_id\n    \n as \n    \n    person_id\n    \n, \n    \n    \n    timestamp\n    \n as \n    \n    timestamp\n    \n, \n    \n    \n    type\n    \n as \n    \n    type\n    \n, \n    \n    \n    uuid\n    \n as \n    \n    uuid\n    \n, \n    \n    \n    property_value\n    \n as \n    \n    property_value\n    \n\n\n\n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n    from base\n),\n\nrename as (\n    \n    select \n        _variation as variation_id,\n        cast(campaign_id as TEXT ) as campaign_id,\n        cast(timestamp as timestamp ) as occurred_at,\n        cast(flow_id as TEXT ) as flow_id,\n        flow_message_id,\n        cast(id as TEXT ) as event_id,\n        cast(metric_id as TEXT ) as metric_id,\n        cast(person_id as TEXT ) as person_id,\n        type,\n        uuid,\n        \n\n    cast(regexp_replace(cast(property_value as TEXT), '[^0-9.]*', '', 'g') as numeric(28,6))\n\n as numeric_value,\n        cast(_fivetran_synced as timestamp ) as _fivetran_synced,\n        source_relation\n        \n\n\n\n\n\n    from fields\n    where not coalesce(_fivetran_deleted, false)\n),\n\nfinal as (\n    \n    select \n        *,\n        cast( date_trunc('day', occurred_at) as date) as occurred_on,\n        md5(cast(coalesce(cast(event_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(source_relation as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as unique_event_id\n\n    from rename\n\n)\n\nselect * from final", "relation_name": "\"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__event\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-29T15:48:02.290919Z", "completed_at": "2024-04-29T15:48:03.306619Z"}, {"name": "execute", "started_at": "2024-04-29T15:48:03.338534Z", "completed_at": "2024-04-29T15:48:03.338544Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.1547348499298096, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.klaviyo_source.stg_klaviyo__campaign", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__campaign_tmp\"\n\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    campaign_type\n    \n as \n    \n    campaign_type\n    \n, \n    \n    \n    created\n    \n as \n    \n    created\n    \n, \n    \n    \n    email_template_id\n    \n as \n    \n    email_template_id\n    \n, \n    \n    \n    from_email\n    \n as \n    \n    from_email\n    \n, \n    \n    \n    from_name\n    \n as \n    \n    from_name\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    send_time\n    \n as \n    \n    send_time\n    \n, \n    \n    \n    sent_at\n    \n as \n    \n    sent_at\n    \n, \n    \n    \n    status\n    \n as \n    \n    status\n    \n, \n    \n    \n    status_id\n    \n as \n    \n    status_id\n    \n, \n    \n    \n    status_label\n    \n as \n    \n    status_label\n    \n, \n    \n    \n    subject\n    \n as \n    \n    subject\n    \n, \n    \n    \n    updated\n    \n as \n    \n    updated\n    \n, \n    \n    \n    archived\n    \n as \n    \n    archived\n    \n, \n    \n    \n    scheduled\n    \n as \n    \n    scheduled\n    \n\n\n\n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n    from base\n),\n\nfinal as (\n    \n    select\n        campaign_type,\n        created as created_at,\n        email_template_id,\n        from_email,\n        from_name,\n        cast(id as TEXT ) as campaign_id,\n        name as campaign_name,\n        send_time as scheduled_to_send_at,\n        sent_at,\n        coalesce(status, lower(status_label)) as status,\n        status_id,\n        subject,\n        updated as updated_at,\n        archived as is_archived,\n        scheduled as scheduled_at,\n        source_relation\n\n    from fields\n\n    where not coalesce(_fivetran_deleted, false)\n)\n\nselect * from final", "relation_name": "\"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__campaign\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-29T15:48:02.311983Z", "completed_at": "2024-04-29T15:48:03.340181Z"}, {"name": "execute", "started_at": "2024-04-29T15:48:03.340640Z", "completed_at": "2024-04-29T15:48:03.340643Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.1358230113983154, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.klaviyo_source.stg_klaviyo__metric", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__metric_tmp\"\n\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    created\n    \n as \n    \n    created\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    integration_id\n    \n as \n    \n    integration_id\n    \n, \n    \n    \n    integration_category\n    \n as \n    \n    integration_category\n    \n, \n    \n    \n    integration_name\n    \n as \n    \n    integration_name\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    updated\n    \n as \n    \n    updated\n    \n\n\n\n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n    from base\n),\n\nfinal as (\n    \n    select \n        created as created_at,\n        cast(id as TEXT ) as metric_id,\n        cast(integration_id as TEXT ) as integration_id,\n        integration_name,\n        integration_category,\n        name as metric_name,\n        updated as updated_at,\n        source_relation\n\n    from fields\n\n    where not coalesce(_fivetran_deleted, false)\n)\n\nselect * from final", "relation_name": "\"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__metric\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-29T15:48:03.462776Z", "completed_at": "2024-04-29T15:48:03.472155Z"}, {"name": "execute", "started_at": "2024-04-29T15:48:03.472845Z", "completed_at": "2024-04-29T15:48:03.472857Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.023581981658935547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.klaviyo_source.not_null_stg_klaviyo__flow_flow_id.a00a897e42", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect flow_id\nfrom \"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__flow\"\nwhere flow_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-29T15:48:03.452397Z", "completed_at": "2024-04-29T15:48:03.473227Z"}, {"name": "execute", "started_at": "2024-04-29T15:48:03.475481Z", "completed_at": "2024-04-29T15:48:03.475486Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.027118921279907227, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.klaviyo_source.dbt_utils_unique_combination_of_columns_stg_klaviyo__flow_flow_id__source_relation.015215d481", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        flow_id, source_relation\n    from \"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__flow\"\n    group by flow_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-29T15:48:03.468226Z", "completed_at": "2024-04-29T15:48:03.474294Z"}, {"name": "execute", "started_at": "2024-04-29T15:48:03.476330Z", "completed_at": "2024-04-29T15:48:03.476336Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02689218521118164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.klaviyo_source.dbt_utils_unique_combination_of_columns_stg_klaviyo__event_event_id__source_relation.3778c651d7", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        event_id, source_relation\n    from \"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__event\"\n    group by event_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-29T15:48:03.478209Z", "completed_at": "2024-04-29T15:48:03.482939Z"}, {"name": "execute", "started_at": "2024-04-29T15:48:03.490085Z", "completed_at": "2024-04-29T15:48:03.490091Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0146942138671875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.klaviyo_source.not_null_stg_klaviyo__event_event_id.7a09ac6ec1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__event\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-29T15:48:03.486470Z", "completed_at": "2024-04-29T15:48:03.491130Z"}, {"name": "execute", "started_at": "2024-04-29T15:48:03.492763Z", "completed_at": "2024-04-29T15:48:03.492768Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.014545202255249023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.klaviyo_source.not_null_stg_klaviyo__campaign_campaign_id.5dfc47dc1d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect campaign_id\nfrom \"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__campaign\"\nwhere campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-29T15:48:03.483182Z", "completed_at": "2024-04-29T15:48:03.491448Z"}, {"name": "execute", "started_at": "2024-04-29T15:48:03.493046Z", "completed_at": "2024-04-29T15:48:03.493049Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.015620231628417969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.klaviyo_source.dbt_utils_unique_combination_of_columns_stg_klaviyo__campaign_campaign_id__source_relation.59158488ff", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        campaign_id, source_relation\n    from \"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__campaign\"\n    group by campaign_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-29T15:48:03.493290Z", "completed_at": "2024-04-29T15:48:03.498116Z"}, {"name": "execute", "started_at": "2024-04-29T15:48:03.499253Z", "completed_at": "2024-04-29T15:48:03.499258Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01099395751953125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.klaviyo_source.dbt_utils_unique_combination_of_columns_stg_klaviyo__metric_metric_id__source_relation.e9f33c04e5", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        metric_id, source_relation\n    from \"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__metric\"\n    group by metric_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-29T15:48:03.499525Z", "completed_at": "2024-04-29T15:48:03.503319Z"}, {"name": "execute", "started_at": "2024-04-29T15:48:03.503810Z", "completed_at": "2024-04-29T15:48:03.503813Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.005822896957397461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.klaviyo_source.not_null_stg_klaviyo__metric_metric_id.4759d62078", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect metric_id\nfrom \"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__metric\"\nwhere metric_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-29T15:48:03.442023Z", "completed_at": "2024-04-29T15:48:04.867484Z"}, {"name": "execute", "started_at": "2024-04-29T15:48:04.869564Z", "completed_at": "2024-04-29T15:48:04.869771Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.557455062866211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.klaviyo_source.stg_klaviyo__person", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__person_tmp\"\n\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_deleted\n    \n as \n    \n    _fivetran_deleted\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    address_1\n    \n as \n    \n    address_1\n    \n, \n    \n    \n    address_2\n    \n as \n    \n    address_2\n    \n, \n    \n    \n    city\n    \n as \n    \n    city\n    \n, \n    \n    \n    country\n    \n as \n    \n    country\n    \n, \n    \n    \n    created\n    \n as \n    \n    created\n    \n, \n    \n    \n    email\n    \n as \n    \n    email\n    \n, \n    \n    \n    first_name\n    \n as \n    \n    first_name\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    last_name\n    \n as \n    \n    last_name\n    \n, \n    \n    \n    latitude\n    \n as \n    \n    latitude\n    \n, \n    \n    \n    longitude\n    \n as \n    \n    longitude\n    \n, \n    \n    \n    organization\n    \n as \n    \n    organization\n    \n, \n    \n    \n    phone_number\n    \n as \n    \n    phone_number\n    \n, \n    \n    \n    region\n    \n as \n    \n    region\n    \n, \n    \n    \n    timezone\n    \n as \n    \n    timezone\n    \n, \n    \n    \n    title\n    \n as \n    \n    title\n    \n, \n    \n    \n    updated\n    \n as \n    \n    updated\n    \n, \n    \n    \n    zip\n    \n as \n    \n    zip\n    \n, \n    \n    \n    last_event_date\n    \n as \n    \n    last_event_date\n    \n\n\n\n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n    from base\n),\n\nfinal as (\n    \n    select \n        cast(id as TEXT ) as person_id,\n        address_1,\n        address_2,\n        city,\n        country,\n        zip,\n        created as created_at,\n        email,\n        first_name || ' ' || last_name as full_name,\n        latitude,\n        longitude,\n        organization,\n        phone_number,\n        region, -- state in USA\n        timezone,\n        title,\n        updated as updated_at,\n        last_event_date,\n        source_relation\n        \n        \n\n\n\n\n\n    from fields\n    where not coalesce(_fivetran_deleted, false)\n)\n\nselect * from final", "relation_name": "\"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__person\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-29T15:48:05.035425Z", "completed_at": "2024-04-29T15:48:05.060203Z"}, {"name": "execute", "started_at": "2024-04-29T15:48:05.074707Z", "completed_at": "2024-04-29T15:48:05.074956Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.06758594512939453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.klaviyo_source.dbt_utils_unique_combination_of_columns_stg_klaviyo__person_person_id__source_relation.33a4f9ca24", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        person_id, source_relation\n    from \"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__person\"\n    group by person_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-29T15:48:05.048298Z", "completed_at": "2024-04-29T15:48:05.065191Z"}, {"name": "execute", "started_at": "2024-04-29T15:48:05.079168Z", "completed_at": "2024-04-29T15:48:05.079178Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05647611618041992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.klaviyo_source.not_null_stg_klaviyo__person_person_id.bd77ffc8aa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect person_id\nfrom \"postgres\".\"klaviyo_source_integration_tests_3_stg_klaviyo\".\"stg_klaviyo__person\"\nwhere person_id is null\n\n\n", "relation_name": null}], "elapsed_time": 6.204125881195068, "args": {"warn_error_options": {"include": [], "exclude": []}, "introspect": true, "vars": {}, "invocation_command": "dbt docs generate -t postgres", "exclude": [], "write_json": true, "log_format": "default", "strict_mode": false, "select": [], "empty_catalog": false, "log_path": "/Users/avinash.kunnath/Documents/dbt_packages/klaviyo/dbt_klaviyo_source/integration_tests/logs", "enable_legacy_logger": false, "project_dir": "/Users/avinash.kunnath/Documents/dbt_packages/klaviyo/dbt_klaviyo_source/integration_tests", "static": false, "use_colors_file": true, "indirect_selection": "eager", "show_resource_report": false, "target": "postgres", "send_anonymous_usage_stats": true, "partial_parse_file_diff": true, "populate_cache": true, "version_check": true, "profiles_dir": "/Users/avinash.kunnath/.dbt", "use_colors": true, "cache_selected_only": false, "which": "generate", "defer": false, "partial_parse": true, "quiet": false, "favor_state": false, "compile": true, "macro_debugging": false, "log_format_file": "debug", "log_level_file": "debug", "log_level": "info", "static_parser": true, "printer_width": 80, "print": true, "log_file_max_bytes": 10485760}}